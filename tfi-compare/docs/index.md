# TFI-Compare 文档中心

> **项目**: TaskFlowInsight — TFI-Compare 模块  
> **版本**: 3.0.0 (当前分支: feature/v4.0.0-routing-refactor)  
> **初版日期**: 2026-02-15  
> **更新日期**: 2026-02-15 (v2 — 代码改进后全量更新)  
> **生成方式**: 专家小组深度研究输出 + v2 迭代更新  

---

## 专家小组成员

| 角色 | 职责 | 输出物 |
|------|------|--------|
| **项目经理** | 协调组织、分配工作、全局把控、质量保证 | 本索引文档 |
| **资深开发专家** | Spring Boot 领域，代码架构分析与评分 | [开发设计文档](design-doc.md) |
| **资深产品经理** | 产品定位、功能需求、竞品分析、版本规划 | [产品 PRD 文档](prd.md) |
| **资深测试专家** | 白盒/黑盒/功能/性能全方位测试方案 | [测试方案文档](test-plan.md) |
| **资深运维专家** | 部署、监控、调优、故障排查、灾难恢复 | [运维文档](ops-doc.md) |

---

## 文档目录

### 1. [开发设计文档](design-doc.md)

架构设计、核心类详解、算法分析、设计模式、SPI 扩展、Spring Boot 集成、线程安全、性能设计，以及 **代码设计评分（v1: 8.06/10 → v2: 8.81/10，A- 优秀）**。

**关键结论**:
- 六层架构分明，SSOT 原则贯穿
- Strategy + SPI 扩展机制成熟
- CompareEngine 排序唯一入口设计优秀
- ✅ v2 改进: System.out 已清除、CompareService 已拆分、DiffDetector volatile 已修复

### 2. [产品 PRD 文档](prd.md)

产品定位、目标用户画像、核心使用场景、功能全景图（7 大功能域）、非功能需求、竞品分析、版本规划。

**关键结论**:
- 覆盖 5 种列表比较策略，业界领先
- 独有特性：PerfGuard 性能预算、@NumericPrecision 精度控制
- 相比 Javers，在三方合并、流式导出、降级机制上有差异化
- ✅ v2 更新: 新增 v3.0.0 改进项记录，KPI 覆盖率指标更新

### 3. [测试方案文档](test-plan.md)

白盒测试（控制流/数据流覆盖）、黑盒测试（等价类/边界值/决策表）、功能测试（18 类场景）、性能测试（10 种基准 + 压力 + 降级）。

**关键结论**:
- 规划 247 个测试用例（白盒 97、黑盒 62、功能 60、性能 28）
- ✅ v2 更新: tfi-compare 模块内 6 个测试文件、95+ test case
- 覆盖率从 ~60% 提升至 ~75%，Phase 1 已达标
- ArchUnit 架构测试 6 条规则已通过

### 4. [运维文档](ops-doc.md)

部署架构、构建发布、配置管理（环境差异表）、Prometheus 监控 + 告警规则、Grafana 面板建议、性能调优（3 种场景）、故障排查手册（5 大常见问题）、灾难恢复预案。

**关键结论**:
- 嵌入式库模式，运维重点在配置调优和监控
- 5 条关键告警规则覆盖延迟/降级/错误率/内存/缓存
- ✅ v2 更新: compareBatch 并发模型变更（parallelStream → Virtual Thread），新增运维说明

### 5. [评分报告](scoring-report.md)

多维度评分详细报告，包含 v1 → v2 改进对照。

---

## 综合评估

| 维度 | v1 评分 | v2 评分 | 说明 |
|------|---------|---------|------|
| **架构成熟度** | ★★★★☆ | ★★★★★ | CompareService 拆分完成，ArchUnit 强制分层 |
| **代码质量** | ★★★★☆ (8.06) | ★★★★☆ (8.81) | System.out 清除，volatile 修复 |
| **功能完整度** | ★★★★★ | ★★★★★ | 保持不变，功能全面 |
| **测试覆盖** | ★★★☆☆ (~60%) | ★★★★☆ (~75%) | 模块内 95+ case，Phase 1 达标 |
| **运维就绪** | ★★★★☆ | ★★★★☆ | 并发模型更新，需补充 Grafana 模板 |
| **文档完整** | ★★★★☆ | ★★★★★ | 5 份专家文档 + 评分报告，全部 v2 更新 |

---

## 下一步行动

| 优先级 | 行动项 | 责任方 | 状态 |
|--------|--------|--------|------|
| ~~P0~~ | ~~清除 System.out.println 调试代码~~ | 开发 | ✅ 已完成 |
| ~~P0~~ | ~~建立 tfi-compare 模块级测试~~ | 测试 | ✅ 已完成（95+ case） |
| ~~P1~~ | ~~拆分 CompareService 职责~~ | 开发 | ✅ 已完成 |
| P1 | 部署 Grafana Dashboard | 运维 | ⏳ 待执行 |
| P1 | 补全 Phase 2 测试（AutoConfig/SPI/降级） | 测试 | ⏳ 待执行 |
| P2 | 完善 API 文档（@since 标签） | 开发 | ⏳ 部分完成 |
| P2 | JMH 系统化 benchmark 基线 | 测试 | ⏳ 待执行 |
| P2 | jqwik 属性测试补充 | 测试 | ⏳ 待执行 |

---

*文档由项目经理汇总输出（v2 更新）*
