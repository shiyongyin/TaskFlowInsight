<?xml version="1.0"?>
<!DOCTYPE module PUBLIC
        "-//Checkstyle//DTD Checkstyle Configuration 1.3//EN"
        "https://checkstyle.org/dtds/configuration_1_3.dtd">

<!--
    tfi-flow-core 专用 Checkstyle 规则。
    基于 Google Java Style Checks，针对项目实际情况合理放宽。

    放宽项：
    - LineLength:       80 -> 120（现代 IDE 宽屏适配）
    - FinalParameters:  禁用（Java 21 风格不需要）
    - JavadocVariable:  禁用（字段注释由 Javadoc/inline 注释覆盖）
    - JavadocStyle:     仅 WARNING（中文 Javadoc 句号格式差异）
    - RegexpSingleline: 行尾空格改为 WARNING
    - HiddenField:      禁用（构造器/setter 同名参数是常见模式）
    - MagicNumber:      禁用（常量定义由 PMD 规则覆盖）
    - DesignForExtension: 禁用（final 类已限制继承）
    - VisibilityModifier: 禁用（测试辅助类需要包可见字段）
    - AvoidStarImport:  禁用（IDE 自动管理 import 排序）
    - NewlineAtEndOfFile: 禁用（OS 间差异）

    保留项（错误级别）：
    - 命名规范（类、方法、变量）
    - 缩进和空格规范
    - NeedBraces（if/else/for/while 必须有花括号）
    - MissingJavadocMethod（公开 API 必须有 Javadoc）
-->
<module name="Checker">
    <property name="charset" value="UTF-8"/>
    <property name="severity" value="error"/>

    <!-- 文件级别检查 -->
    <module name="FileTabCharacter">
        <property name="eachLine" value="true"/>
    </module>

    <!-- 行长度（Checker 级别） -->
    <module name="LineLength">
        <property name="max" value="120"/>
        <!-- 忽略 import 和 URL -->
        <property name="ignorePattern" value="^import |^package |a]? href|^\s+\* "/>
    </module>

    <!-- TreeWalker 模块（AST 级别检查） -->
    <module name="TreeWalker">

        <!-- ==================== 命名规范 ==================== -->
        <module name="PackageName">
            <property name="format" value="^[a-z]+(\.[a-z][a-z0-9]*)*$"/>
        </module>
        <module name="TypeName"/>
        <module name="MethodName">
            <property name="format" value="^[a-z][a-zA-Z0-9]*$"/>
        </module>
        <module name="MemberName">
            <property name="format" value="^[a-z][a-zA-Z0-9]*$"/>
        </module>
        <module name="ParameterName">
            <property name="format" value="^[a-z][a-zA-Z0-9]*$"/>
        </module>
        <module name="LocalVariableName">
            <property name="format" value="^[a-z][a-zA-Z0-9]*$"/>
        </module>
        <module name="ConstantName">
            <property name="format" value="^[A-Z][A-Z0-9]*(_[A-Z0-9]+)*$|^log(ger)?$|^[a-z][a-zA-Z0-9]*$"/>
        </module>

        <!-- ==================== 导入 ==================== -->
        <module name="RedundantImport"/>
        <module name="UnusedImports"/>

        <!-- ==================== 代码块 ==================== -->
        <module name="NeedBraces"/>
        <module name="EmptyBlock">
            <property name="option" value="TEXT"/>
        </module>

        <!-- ==================== Javadoc ==================== -->
        <module name="MissingJavadocMethod">
            <property name="scope" value="public"/>
            <property name="allowMissingPropertyJavadoc" value="true"/>
            <property name="minLineCount" value="2"/>
        </module>

        <!-- ==================== 编码 ==================== -->
        <module name="EmptyStatement"/>
        <module name="EqualsHashCode"/>
        <module name="SimplifyBooleanExpression"/>
        <module name="SimplifyBooleanReturn"/>

        <!-- ==================== 空格 ==================== -->
        <module name="GenericWhitespace"/>
        <module name="NoWhitespaceBefore"/>
        <module name="WhitespaceAfter"/>

    </module>
</module>
