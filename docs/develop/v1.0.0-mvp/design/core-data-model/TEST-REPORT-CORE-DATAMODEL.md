%23 核心数据模型 — 单元测试与性能测试报告

说明：本报告用于阶段三“测试与审核”的结果沉淀。完成测试后回填各小节内容与指标数据。

## 1. 概述
- 代码版本（Git 提交/分支）：
- 测试日期/执行人：
- 覆盖范围：Session / TaskNode / Message / 枚举与工具

## 2. 执行环境
- JDK：Java 21（供应商/构建号）
- OS/CPU/内存：
- 构建工具：Maven（版本）
- 其他：JVM 参数/限频说明/CI 环境（如有）

## 3. 测试范围与用例矩阵
| 模块 | 用例组 | 目标 | 关键点 |
|------|--------|------|--------|
| Session | 创建/结束/幂等/时长 | 功能/边界 | 运行中/完成后时长、无根节点时行为 |
| TaskNode | 父子/路径/序号/时长 | 功能/边界 | 自身/累计口径、消息记录、异常参数 |
| Message | 不可变性/时间戳 | 功能 | 类型口径（最小必要集）、格式化 |
| 并发 | 可见性/一致性 | 并发 | 多线程读/写边界、稳定性 |
| 性能 | 创建/操作/统计 | 性能 | 预算对比、JMH/计时器结果 |

## 4. 结果汇总
- 业务用例通过率：X%（通过/共计）
- 覆盖率（Jacoco，如启用）：
  - 行覆盖：X%
  - 分支覆盖：X%
  - 方法覆盖：X%
- 并发测试：通过/失败用例统计（摘要）
- 性能测试：达标/未达标项摘要（详见第 6 节）

## 5. 业务测试详情（节选）
- Session：
  - 用例：创建→结束幂等→时长校验（运行中/完成后）
  - 结果：
- TaskNode：
  - 用例：addChild 路径/序号校验、getDurationNanos/getAccumulatedDurationMillis、一致性
  - 结果：
- Message：
  - 用例：不可变性、类型、时间戳格式化
  - 结果：

## 6. 性能测试（指标与对比）
- 预算/指标（任务卡）：
  - TaskNode 创建：10000 次平均 < 5 μs
  - 时长计算方法：平均 < 1 μs
- 实测（硬件/JVM 如第 2 节）：
  - TaskNode 创建：X μs（平均），方差/百分位：...
  - 时长计算：X μs（平均），方差/百分位：...
- 结论：达标 / 未达标（偏差 = X%），影响与建议：

## 7. 并发与稳定性
- 测试描述：并发读/写/层级构建/长时间运行
- 结果：无数据竞争/无死锁/资源清理正常（是/否），异常日志：

## 8. 缺陷与问题
| ID | 模块 | 严重度 | 描述 | 现状/修复建议 |
|----|------|--------|------|----------------|
| D-001 | TaskNode | 中 | 累计口径与文档口径不一致 | 建议统一为… |

## 9. 结论与验收判断
- 业务功能：满足 / 部分满足（差距点：…）
- 覆盖率：达标 / 未达标（差距点：…）
- 性能：达标 / 未达标（差距点：…）
- 并发稳定性：达标 / 未达标
- 最终结论：通过 / 待修复后复测

## 10. 后续动作与协助需求
- 需优化项：
- 资源/协助：
- 计划时间：

