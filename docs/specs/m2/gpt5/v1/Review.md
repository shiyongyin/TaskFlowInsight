1. 评分（0–10）
- 功能契合：9 — 按 M2 主题分三阶段落地，范围与仓库现实一致；M0 收敛到显式 API + 标量 Diff + 与任务树联动。
- 稳定性：8 — 异常隔离沿用 `TFI.handleInternalError` 模式；会话边界清理；环形缓冲防止内存胀大。
- 性能风险：7 — 反射/递归/集合 Diff 具潜在开销；通过字段/深度/集合策略限流与缓存降低风险。
- 可扩展性：8 — 明确 SPI 扩展点（Diff/脱敏/序列化/存储），与既有导出/上下文解耦。
- 过度设计：3（越低越好）— M0 明确收敛，M1/M2 才进入集合/回放/外部存储。

2. 主要风险（触发条件 → 监控 → 缓解/回滚）
- 反射读取热路径抖动 → 导出计数/耗时直方图 → 缓存 Property 元数据；限制 `maxFields/maxDepth`；必要时关闭变更追踪。
- 集合/Map 大对象 Diff 过载 → 统计集合尺寸与比较耗时 → M0 禁止集合，M1 仅“增删替换”摘要；超阈值直接跳过并记 WARN。
- 内存占用激增（长会话/高频变更） → 监控条目数与丢弃数 → 环形缓冲与会话完成立即清理；超过水位降级为仅消息。
- 隐私泄漏（敏感值导出） → 导出任务计数/敏感字段命中率 → 默认脱敏 + 白名单；导出需显式开启并校验目录权限。
- 设计漂移（与核心任务树耦合） → PR 审查清单覆盖“无交叉写” → 仅通过消息与 sessionId 关联，禁止直接改写 TaskNode 结构。

3. 差异速览（与旧版 PRD/Design 的关键变更）
- 将“基础注解支持”由 P0 下调至 M1，符合当前代码现状；M0 以显式 API 为主。
- 采纳《ChangeTracking-MVP》极简 API 作为 M0 基线；《Architecture/Balanced》内容延后至 M1/M2。
- 增加“会话边界清理 + 环形缓冲”与“导出最小化”作为非功能硬约束。

4. 行动项（优先级、Owner、DDL、验收证据）
- P0：实现 M2-M0（2 周）
  - Owner：SA/Dev；DDL：T+14；证据：
    - 代码：`TFI.track/trackAll/getChanges/clearAllTracking`、`ChangeTracker/ObjectSnapshot/DiffDetector`、Console/JSON 集成。
    - 测试：单元/集成/性能基准报告；P95 指标达标。
    - 文档：接入指南与示例。
- P1：实现 M2-M1（3 周）
  - Owner：SA/Dev；DDL：M0+3 周；证据：
    - SPI 策略、集合/Map 摘要 Diff、注解+AOP 样例、检索与时间线、导出滚动。
- P2：实现 M2-M2（3 周）
  - Owner：SA/Dev；DDL：M1+3 周；证据：
    - 回放 API、外部存储适配点、可视化联动增强。

5. 假设与缺失输入（后续如何补证）
- 缺失：仓库不存在变更追踪实现/注解/存储接口。
  - 处理：以 M0/M1/M2 三阶段新增；本设计中以 TODO 明示新增工件与位置。
- 假设：导出路径具可写权限；不在 Actuator 暴露敏感值。
  - 处理：在配置中心提供显式开关与校验；导出失败降级。

